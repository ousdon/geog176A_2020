<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Xingxin Li" />


<title>lab4</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/simplex.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 41px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h2 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h3 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h4 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h5 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h6 {
  padding-top: 46px;
  margin-top: -46px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My First Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="geog176A.html">
    <span class="fa fa-pencil-ruler"></span>
     
    Geography 176A Work
  </a>
</li>
<li>
  <a href="CV.html">
    <span class="fa fa-sticky-note"></span>
     
    CV
  </a>
</li>
<li>
  <a href="day-07.html">
    <span class="fa fa-accusoft"></span>
     
    day-07
  </a>
</li>
<li>
  <a href="day13.html">
    <span class="fa fa-accusoft"></span>
     
    day-13
  </a>
</li>
<li>
  <a href="day16.html">
    <span class="fa fa-accusoft"></span>
     
    day-16
  </a>
</li>
<li>
  <a href="lab2.html">
    <span class="fa fa-accusoft"></span>
     
    Lab2
  </a>
</li>
<li>
  <a href="lab3.html">
    <span class="fa fa-accusoft"></span>
     
    Lab3
  </a>
</li>
<li>
  <a href="lab-04.html">
    <span class="fa fa-accusoft"></span>
     
    Lab4
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ousdon/geog176a-lab1">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">lab4</h1>
<h4 class="author">Xingxin Li</h4>
<h4 class="date">8/27/2020</h4>

</div>


<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ──────────────────────────────────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.2     ✓ purrr   0.3.4
## ✓ tibble  3.0.3     ✓ dplyr   1.0.2
## ✓ tidyr   1.1.1     ✓ stringr 1.4.0
## ✓ readr   1.3.1     ✓ forcats 0.5.0</code></pre>
<pre><code>## ── Conflicts ─────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(sf)</code></pre>
<pre><code>## Linking to GEOS 3.8.1, GDAL 3.1.1, PROJ 6.3.1</code></pre>
<pre class="r"><code>library(USAboundaries)
library(rmapshaper)</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;geojsonlint&#39;:
##   method         from 
##   print.location dplyr</code></pre>
<pre class="r"><code>library(kableExtra)</code></pre>
<pre><code>## 
## Attaching package: &#39;kableExtra&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     group_rows</code></pre>
<pre class="r"><code>library(units)</code></pre>
<pre><code>## udunits system database from /Library/Frameworks/R.framework/Versions/4.0/Resources/library/units/share/udunits</code></pre>
<pre class="r"><code>library(plotrix)
library(knitr)
library(ggplot2)
library(readxl)
library(dplyr)
library(gghighlight)</code></pre>
<pre class="r"><code>#1.1
conus = USAboundaries::us_counties() %&gt;%
  filter(!state_name %in% c(&quot;Puerto Rico&quot;, &quot;Alaska&quot;, &quot;Hawaii&quot;)) %&gt;%
  st_transform(5070)</code></pre>
<pre class="r"><code>#1.2
conus_ms &lt;- us_states() %&gt;%
  filter(!(state_name %in% c(&#39;Puerto Rico&#39;, &#39;Alaska&#39;, &#39;Hawaii&#39;))) %&gt;% 
  st_as_sf(coords = c(&quot;lng&quot;,&quot;lat&quot;), crs = 5326) %&gt;%  
  st_transform(5070)

conus_ms = ms_simplify(conus, keep = 0.05)

county_centroid = st_centroid(conus_ms) %&gt;%
  st_combine() %&gt;%
  st_cast(&quot;MULTIPOINT&quot;)</code></pre>
<pre class="r"><code>#1.3
county_centroid_u = st_union(county_centroid)

v_grid = st_voronoi(county_centroid) %&gt;% 
  st_cast() %&gt;% 
  st_as_sf() %&gt;% 
  mutate(id = 1:n())

t_grid = st_triangulate(county_centroid) %&gt;% 
  st_cast() %&gt;% 
  st_as_sf() %&gt;% 
  mutate(id = 1:n())

sq_grid = st_make_grid(county_centroid, n = c(70, 50)) %&gt;% 
  st_as_sf() %&gt;% 
  mutate(id = 1:n())

hex_grid = st_make_grid(county_centroid, n = c(70, 50), square = FALSE) %&gt;% 
  st_as_sf() %&gt;% 
  mutate(id = 1:n())</code></pre>
<pre class="r"><code>#1.4 - 1.7
plot_tess = function(data, title){
  ggplot() + 
    geom_sf(data = data, fill = &quot;white&quot;, col = &quot;navy&quot;, size = .2) +   
    theme_void() +
    labs(title = title, caption = paste(&quot;This tesselation has:&quot;, nrow(data), &quot;tiles&quot; )) +
    theme(plot.title = element_text(hjust = .5, color =  &quot;navy&quot;, face = &quot;bold&quot;))
}

plot_tess(data = conus_ms, &quot;Counties Coverage&quot;)</code></pre>
<p><img src="lab-04_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code>v_grid = st_intersection(v_grid, st_union(conus_ms))
plot_tess(v_grid, &quot;Voronoi Coverage&quot;) </code></pre>
<p><img src="lab-04_files/figure-html/unnamed-chunk-5-2.png" width="672" /></p>
<pre class="r"><code>t_grid = st_intersection(t_grid, st_union(conus_ms))
plot_tess(t_grid, &quot;Triangulated Coverage&quot;) </code></pre>
<p><img src="lab-04_files/figure-html/unnamed-chunk-5-3.png" width="672" /></p>
<pre class="r"><code>sq_grid = st_intersection(sq_grid, st_union(conus_ms))
plot_tess(sq_grid, &quot;Square Coverage&quot;) </code></pre>
<p><img src="lab-04_files/figure-html/unnamed-chunk-5-4.png" width="672" /></p>
<pre class="r"><code>hex_grid = st_intersection(hex_grid, st_union(conus_ms))
plot_tess(hex_grid, &quot;Hexagon Coverage&quot;) </code></pre>
<p><img src="lab-04_files/figure-html/unnamed-chunk-5-5.png" width="672" /></p>
<pre class="r"><code>#2.1
total_tess = function(data, title){
    area = st_area(data) %&gt;% 
    units::set_units(&quot;km2&quot;) %&gt;%
    units::drop_units() 
  
data_frame(title, nrow(data), mean(area), sd(area), sum(area)) 
}</code></pre>
<pre class="r"><code>#2.2 
total_tess(conus_ms, &quot;Raw_original&quot;)</code></pre>
<pre><code>## # A tibble: 1 x 5
##   title        `nrow(data)` `mean(area)` `sd(area)` `sum(area)`
##   &lt;chr&gt;               &lt;int&gt;        &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;
## 1 Raw_original         3075        2544.      3428.    7822757.</code></pre>
<pre class="r"><code>total_tess(v_grid, &quot;Voronoi&quot;)</code></pre>
<pre><code>## # A tibble: 1 x 5
##   title   `nrow(data)` `mean(area)` `sd(area)` `sum(area)`
##   &lt;chr&gt;          &lt;int&gt;        &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;
## 1 Voronoi         3075        2544.      2894.    7822757.</code></pre>
<pre class="r"><code>total_tess(t_grid, &quot;Triangulation&quot;)</code></pre>
<pre><code>## # A tibble: 1 x 5
##   title         `nrow(data)` `mean(area)` `sd(area)` `sum(area)`
##   &lt;chr&gt;                &lt;int&gt;        &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;
## 1 Triangulation         6130        1263.      1583.    7740190.</code></pre>
<pre class="r"><code>total_tess(sq_grid, &quot;Square&quot;)</code></pre>
<pre><code>## # A tibble: 1 x 5
##   title  `nrow(data)` `mean(area)` `sd(area)` `sum(area)`
##   &lt;chr&gt;         &lt;int&gt;        &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;
## 1 Square         1635        3484.       401.    5696590.</code></pre>
<pre class="r"><code>total_tess(hex_grid, &quot;Hexagon&quot;)</code></pre>
<pre><code>## # A tibble: 1 x 5
##   title   `nrow(data)` `mean(area)` `sd(area)` `sum(area)`
##   &lt;chr&gt;          &lt;int&gt;        &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;
## 1 Hexagon         1633        3501.       352.    5716720.</code></pre>
<pre class="r"><code>#2.3
tess_summary = bind_rows(
  total_tess(conus_ms, &quot;Raw_original&quot;),
  total_tess(v_grid, &quot;Voroni&quot;),
  total_tess(t_grid, &quot;Triangulation&quot;),
  total_tess(sq_grid, &quot;Square&quot;),
  total_tess(hex_grid, &quot;Hexagon&quot;))</code></pre>
<pre class="r"><code>#2.4
knitr::kable(tess_summary,
caption = &quot;Types of Tessellation&quot;,
col.names = c(&quot;Name&quot;,&quot;Numbers&quot;,&quot;Mean_Area&quot;,&quot;Sd_Area(km2)&quot;,&quot;Sum_Area&quot;),
format.args = list(big.mark = &quot;,&quot;)) %&gt;%
kableExtra::kable_styling(&quot;basic&quot;, full_width = TRUE, font_size = 16)</code></pre>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Types of Tessellation
</caption>
<thead>
<tr>
<th style="text-align:left;">
Name
</th>
<th style="text-align:right;">
Numbers
</th>
<th style="text-align:right;">
Mean_Area
</th>
<th style="text-align:right;">
Sd_Area(km2)
</th>
<th style="text-align:right;">
Sum_Area
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Raw_original
</td>
<td style="text-align:right;">
3,075
</td>
<td style="text-align:right;">
2,543.986
</td>
<td style="text-align:right;">
3,428.2080
</td>
<td style="text-align:right;">
7,822,757
</td>
</tr>
<tr>
<td style="text-align:left;">
Voroni
</td>
<td style="text-align:right;">
3,075
</td>
<td style="text-align:right;">
2,543.986
</td>
<td style="text-align:right;">
2,894.3919
</td>
<td style="text-align:right;">
7,822,757
</td>
</tr>
<tr>
<td style="text-align:left;">
Triangulation
</td>
<td style="text-align:right;">
6,130
</td>
<td style="text-align:right;">
1,262.674
</td>
<td style="text-align:right;">
1,583.2598
</td>
<td style="text-align:right;">
7,740,190
</td>
</tr>
<tr>
<td style="text-align:left;">
Square
</td>
<td style="text-align:right;">
1,635
</td>
<td style="text-align:right;">
3,484.153
</td>
<td style="text-align:right;">
400.9774
</td>
<td style="text-align:right;">
5,696,590
</td>
</tr>
<tr>
<td style="text-align:left;">
Hexagon
</td>
<td style="text-align:right;">
1,633
</td>
<td style="text-align:right;">
3,500.747
</td>
<td style="text-align:right;">
352.0933
</td>
<td style="text-align:right;">
5,716,720
</td>
</tr>
</tbody>
</table>
<p>#2.5 The different types of tessellation have different type of shapes and result that might effect on calculation on analysis, the counties tessellation is the most regulate shapes on the tessellation it gives good enough information rather the rest. The voronoi tessellation is more spread by proportion of the nearby area and it shape in variety, it used more in convex domain with connect distance. The triangulation tessellation have more on regular triangle shape than voronoi tessellation and if the point is inside the permanent circle of the triangle, it is easy to cause a sharper angle. The square and hexagon tessellation can have less edge effects and offer an alternative to square.</p>
<pre class="r"><code>#3.1
nid2019 &lt;- read_excel(&quot;/Users/xingxin/Github/geog176a-summer-2020-lab1/NID2019_U.xlsx&quot;) %&gt;%
  filter(!is.na(LONGITUDE)) %&gt;% 
  filter(!is.na(LATITUDE))

dam2019 &lt;- nid2019 %&gt;%
  st_as_sf(coords = c(&quot;LONGITUDE&quot;, &quot;LATITUDE&quot;), crs = 4326) %&gt;%
  st_transform(5070) %&gt;%
  st_filter(conus)</code></pre>
<pre class="r"><code>#3.2
point_in_polygon = function(points, polygon, id){
    st_join(polygon, points) %&gt;%
    st_drop_geometry() %&gt;%
    dplyr::count(.data[[id]]) %&gt;%
    setNames(c(id, &quot;n&quot;)) %&gt;%
    left_join(polygon, by = id) %&gt;%
    st_as_sf()
}</code></pre>
<pre class="r"><code>#3.3
cpip = point_in_polygon(dam2019, conus_ms, &quot;geoid&quot;)
vpip = point_in_polygon(dam2019, v_grid, &quot;id&quot;)
tpip = point_in_polygon(dam2019, t_grid, &quot;id&quot;)
spip = point_in_polygon(dam2019, sq_grid, &quot;id&quot;)
hpip = point_in_polygon(dam2019, hex_grid, &quot;id&quot;)</code></pre>
<pre class="r"><code>#3.4
plot_tess = function(data, title)
  {ggplot() +
    geom_sf(data = data, aes(fill = log(n)), alpha = .9, size = .2, col = NA) +
    scale_fill_viridis_c() +
    theme_void() +
    theme(legend.position = &#39;none&#39;,
          plot.title = element_text(face = &quot;bold&quot;, color = &quot;navy&quot;, hjust = .5, size = 24)) +
    labs(title = title,
         caption = paste0(sum(data$n), &quot; Number of Dams &quot;))}</code></pre>
<pre class="r"><code>#3.5
plot_tess(cpip, &quot;Dams Counties&quot;)</code></pre>
<p><img src="lab-04_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre class="r"><code>plot_tess(vpip, &quot;Dams Voronoi&quot;)</code></pre>
<p><img src="lab-04_files/figure-html/unnamed-chunk-14-2.png" width="672" /></p>
<pre class="r"><code>plot_tess(tpip, &quot;Dams Triangulated&quot;)</code></pre>
<p><img src="lab-04_files/figure-html/unnamed-chunk-14-3.png" width="672" /></p>
<pre class="r"><code>plot_tess(spip, &quot;Dams Square&quot;)</code></pre>
<p><img src="lab-04_files/figure-html/unnamed-chunk-14-4.png" width="672" /></p>
<pre class="r"><code>plot_tess(hpip, &quot;Dams Hexagon&quot;)</code></pre>
<p><img src="lab-04_files/figure-html/unnamed-chunk-14-5.png" width="672" /></p>
<p>#3.6 According to the lecture note, MAUP is a source of statistical bias that can significantly impact the results of statistical hypothesis tests. Therefore, I will choose the voronoi to moving forward because in these four results, the triangulated tessellation is out of the visualization of seeing the spread of dams in the U.S. and the square and hexagon tessellation is missing some part of the data in the western America. The voronoi tessellation is more match the counties map display and gives a good ratio visualize on the distribution of the dams in the Country.</p>
<pre class="r"><code>#4 - 4.1
unique(dam2019$PURPOSES) %&gt;% length</code></pre>
<pre><code>## [1] 492</code></pre>
<pre class="r"><code>nid_classifier = data.frame(abbr = c(&quot;C&quot;,&quot;S&quot;,&quot;P&quot;,&quot;F&quot;),
                 purpose = c(&quot;Flood Control&quot;,&quot;Water Supply&quot;,&quot;Fire Protection&quot;,&quot;Fish and Wildlife&quot;))

dam_freq &lt;- strsplit(dam2019$PURPOSES, split = &quot;&quot;) %&gt;%
  unlist() %&gt;% 
  table() %&gt;% 
  as.data.frame() %&gt;% 
  setNames(c(&quot;abbr&quot;, &quot;count&quot;)) %&gt;% 
  left_join(nid_classifier) %&gt;% 
  mutate(lab = paste0(purpose, &quot;\n(&quot;, abbr, &quot;)&quot;))</code></pre>
<p>#The steps I followed on Mike instrction to indetify how many dams serve each purpose by splitting the PURPOSES values. The data what I choosing to use are Flood Control, Water Supply, Fire Protection, and Fish and Wildlife for my chosen because of the flood controls is the most important thing for natural disaster and Water Supply is huge hydrology industry provide people water usage, the fire protection is because it can avoid fire and the fish and wildlife is maintain the environment cycle.</p>
<pre class="r"><code>#4.1 - 4.2

#Flood Control
FC_dam &lt;- dam2019 %&gt;% 
  filter(grepl(&quot;C&quot;, dam2019$PURPOSES) == TRUE)
point_in_polygon(FC_dam, v_grid, &quot;id&quot;) %&gt;% 
  plot_tess(&quot;Flood Control Dams Map&quot;) +
  theme_void() +
  theme(legend.position = &#39;none&#39;,
    plot.title = element_text(face = &quot;bold&quot;, color = &quot;navy&quot;, hjust = .5, size = 24)) +
  gghighlight(n &gt; (mean(n) + sd(n)))</code></pre>
<p><img src="lab-04_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<pre class="r"><code># Water Supply
Was_dam &lt;- dam2019 %&gt;% 
  filter(grepl(&quot;S&quot;, dam2019$PURPOSES) == TRUE)
point_in_polygon(Was_dam, v_grid, &quot;id&quot;) %&gt;% 
  plot_tess(&quot;Water Supply Dams Map&quot;) +
  theme_void() +
  theme(legend.position = &#39;none&#39;,
          plot.title = element_text(face = &quot;bold&quot;, color = &quot;navy&quot;, hjust = .5, size = 24)) +
  gghighlight(n &gt; (mean(n) + sd(n)))</code></pre>
<p><img src="lab-04_files/figure-html/unnamed-chunk-16-2.png" width="672" /></p>
<pre class="r"><code>#Protection
FP_dam &lt;- dam2019 %&gt;% 
  filter(grepl(&quot;P&quot;, dam2019$PURPOSES) == TRUE)
point_in_polygon(FP_dam, v_grid, &quot;id&quot;) %&gt;%
  plot_tess(&quot;Fire Protection Dams Map&quot;) +
  theme_void() +
  theme(legend.position = &#39;none&#39;,
          plot.title = element_text(face = &quot;bold&quot;, color = &quot;navy&quot;, hjust = .5, size = 24)) +
  gghighlight(n &gt; (mean(n) + sd(n)))</code></pre>
<p><img src="lab-04_files/figure-html/unnamed-chunk-16-3.png" width="672" /></p>
<pre class="r"><code>#Fish and Wildlife
Faw_dam &lt;- dam2019 %&gt;% 
  filter(grepl(&quot;F&quot;, dam2019$PURPOSES) == TRUE)
point_in_polygon(Faw_dam, v_grid, &quot;id&quot;) %&gt;%
  plot_tess(&quot;Fish and Wildlife Dams Map&quot;) +
  theme_void() +
  theme(legend.position = &#39;none&#39;,
          plot.title = element_text(face = &quot;bold&quot;, color = &quot;navy&quot;, hjust = .5, size = 24)) +
  gghighlight(n &gt; (mean(n) + sd(n)))</code></pre>
<p><img src="lab-04_files/figure-html/unnamed-chunk-16-4.png" width="672" /></p>
<p>#4.3 In the results, it matches the geographic of the distribution of dams because most of the dams are located nearby the areas of drainage basin, gulfs/bays and the mountain range. It’s good to see all these geographic of the distribution in the US geography. The flood controls are most located in side of the Mississippi River, Water Supply Dam are more located in agricultural area and shortage water area with many population. The Fire Protection are more located in the area have more forest and wood. The Fish and Wildlife area are located more in the Mid-West which is the distribution area of wildlife.</p>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
